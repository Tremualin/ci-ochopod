<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Operations &mdash; ci-ochopod 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ci-ochopod 1.0 documentation" href="index.html" />
    <link rel="prev" title="CD" href="cd.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="cd.html" title="CD"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">ci-ochopod 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="operations">
<h1>Operations<a class="headerlink" href="#operations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="ci-backend-deployment">
<h2>CI Backend Deployment<a class="headerlink" href="#ci-backend-deployment" title="Permalink to this headline">¶</a></h2>
<p>You first need a <a class="reference external" href="http://mesos.apache.org/">Mesos</a> cluster equipped with <a class="reference external" href="https://github.com/autodesk-cloud/ochothon">Ochothon</a> (please refer to their respective documentations).</p>
<p>The <em>YAML definition</em> to use for each component can be found in the repository (grep for <em>marathon.yml</em>). Please note
some of them specify settings that are not defaulted (especially for the slave image). You can copy them all in one
place and edit them according to your needs.</p>
<p>Go ahead and add all those pods in an arbitrary &#8220;ci&#8221; namespace. We need at least one <em>hook</em> (to receive HTTP POST
requests from Git), one <em>redis</em> and a set of <em>slaves</em>. Let&#8217;s pick 3 slaves for the sake of illustration. For instance:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ cli.py
54.164.112.137 &gt; deploy -n ci images/marathon/hook/marathon.yml -t 120
54.164.112.137 &gt; deploy -n ci images/marathon/redis/marathon.yml -t 120
54.164.112.137 &gt; deploy -n ci images/marathon/slave/marathon.yml -p 3 -t 120
</pre></div>
</div>
<p>Once this is done you should have 5 pods running on your cluster:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ cli.py
54.164.112.137 &gt; ls
5 pods, 100% replies -&gt;

cluster                     |  ok   |  status
                            |       |
ci.hook                     |  1/1  |
ci.redis                    |  1/1  |
ci.slave                    |  3/3  |
</pre></div>
</div>
<p>Note the <em>hook</em> URL (and make sure it is reachable from your Git deployment). The container will bind to its host&#8217;s
TCP 5000. For instance:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ cli.py
54.164.112.137 &gt; grep *hook
1 pods, 100% replies -&gt;
</pre></div>
</div>
<p>Pay also attention to the <em>hook</em> auto-generated secret token. This random identifier must be used when setting up your
Git web-hook. For instance:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ cli.py
54.164.112.137 &gt; poll *hook
1 pods, 100% replies -&gt;
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/autodesk-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Operations</a><ul>
<li><a class="reference internal" href="#ci-backend-deployment">CI Backend Deployment</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="cd.html" title="previous chapter">CD</a></li>
  </ul></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2015, Autodesk.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  
  </body>
</html>